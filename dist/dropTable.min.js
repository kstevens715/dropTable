/*! Drag, Drop & Process data from spreadsheet - v0.1.0 - 2013-04-07
* https://github.com/kstevens715/dropTable
* Copyright (c) 2013 Kyle Stevens; Licensed MIT */
(function(e){var r,t,a="Badge",n=[],o={init:function(r){t=e.extend({fnProcessRow:null,fnDropComplete:null,delayProcessing:!1,fieldDelimiter:"	",dataFormat:"Text",columnDefinitions:null},r),this.on("dragover",o.dragOver),this.on("drop",o.drop),this.on("dragenter",o.dragEnter),this.on("dragleave",o.dragLeave),o.renderDropTable()},drop:function(e){var r=e.originalEvent.dataTransfer.getData(t.dataFormat);return n=o.parseData(r),t.delayProcessing||i.process(),o.renderTable(),"function"==typeof t.fnDropComplete&&t.fnDropComplete(),!0},dragOver:function(e){return o.isBadge(e)},dragEnter:function(){return!1},dragLeave:function(){return!1},isBadge:function(e){var r=e.originalEvent.dataTransfer.getData(a);return""===r?!1:!0},parseData:function(r){return e.csv.toArrays(r,{separator:t.fieldDelimiter})},renderDropTable:function(){var e="<div class='droptable-sidebar'></div><div class='droptable-droparea'><p>Drop Data Here!</p></div>";r.html(e),o.renderSidebar()},renderSidebar:function(){var e='<div><ul class="droptable-columndefinitions unstyled">';for(var a in t.columnDefinitions)e+="<li>",e+='<span class="badge" draggable="true" ',e+='ondragstart="',e+="event.dataTransfer.setData('Badge', '"+a+"')\"",e+=">",e+=a,e+="</span></li>";e+="</ul></div>",r.find(".droptable-sidebar").html(e)},renderTable:function(){var e,t,a,o='<table class="table table-striped table-bordered">';for(o+="<thead>",o+='<tr><th><span class="badge">test</span></th><th></th><th></th></tr>',o+="</thead>",o+="<tbody>",t=0;n.length>t;t++){for(e=n[t],o+="<tr>",a=0;e.length>a;a++)o=o+"<td>"+e[a]+"</td>";o+="</tr>"}o+="</tbody>",o+="</table>",r.find(".droptable-droparea").html(o)}},i={process:function(){var e,r;if("function"==typeof t.fnProcessRow)for(r=0;n.length>r;r++)e=n[r],t.fnProcessRow(e,r+1)}};e.fn.dropTable=function(e){return r=this,i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e||o.init.apply(this,arguments),this}})(jQuery);